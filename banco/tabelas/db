-- -----------------------------------------------------
-- Documentação do Schema do Banco de Dados
-- Projeto: Gestor Financeiro Pessoal
-- Banco de Dados: MySQL
-- -----------------------------------------------------

-- Criação do Banco (caso vá rodar do zero)
CREATE DATABASE IF NOT EXISTS financas_pessoais
CHARACTER SET utf8mb4
COLLATE utf8mb4_unicode_ci;

-- 1. Tabela de Categorias
-- Armazena os grupos de gastos (ex: Alimentação, Lazer) e Receitas
CREATE TABLE IF NOT EXISTS categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    color_hex VARCHAR(7) DEFAULT '#CCCCCC', -- Código hexadecimal da cor para gráficos
    type ENUM('RECEITA', 'DESPESA') NOT NULL -- Define se é entrada ou saída
);

-- 2. Tabela de Transações
-- Armazena cada movimentação financeira (Gasto ou Ganho)
CREATE TABLE IF NOT EXISTS transactions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    description VARCHAR(255) NOT NULL,
    amount DECIMAL(10, 2) NOT NULL, -- Valor monetário (10 dígitos, 2 decimais)
    transaction_date DATE NOT NULL,
    category_id INT,
    is_fixed BOOLEAN DEFAULT FALSE, -- Se TRUE, é uma conta fixa (ex: Aluguel)
    is_paid BOOLEAN DEFAULT FALSE,  -- Se TRUE, o dinheiro já saiu da conta
    payment_method VARCHAR(50),     -- Ex: 'PIX', 'CREDITO', 'DEBITO', 'DINHEIRO'
    
    -- Relacionamento com Categorias
    FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE SET NULL
);

-- 3. Tabela de Modelos de Recorrência
-- Armazena os "moldes" para gerar contas fixas automaticamente todo mês
CREATE TABLE IF NOT EXISTS recurring_templates (
    id INT AUTO_INCREMENT PRIMARY KEY,
    description VARCHAR(255) NOT NULL,
    category_id INT,
    estimated_amount DECIMAL(10, 2), -- Valor previsto (pode mudar na fatura real)
    active BOOLEAN DEFAULT TRUE,     -- Se FALSE, o sistema para de gerar esta conta
    
    -- Relacionamento com Categorias
    FOREIGN KEY (category_id) REFERENCES categories(id)
);